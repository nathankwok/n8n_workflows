{
  "createdAt": "2025-08-16T19:58:14.381Z",
  "updatedAt": "2025-08-16T21:07:29.774Z",
  "id": "aWQxKVUGIdQdrcGd",
  "name": "Backup_Credentials",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "hours"
            }
          ]
        }
      },
      "id": "30f552bb-4ccd-4bb2-b766-a6e583802ea3",
      "name": "Schedule Trigger",
      "type": "n8n-nodes-base.scheduleTrigger",
      "position": [
        -1024,
        320
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "U7Jh9njKLEjGLVIl",
          "cachedResultName": "n8n Backup Changes"
        },
        "workflowInputs": {
          "value": {
            "filePath": "={{ $('Set Workflow Path').item.json.filePath }}"
          },
          "schema": [
            {
              "id": "filePath",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "filePath",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "filePath"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "id": "fc4e18f5-cd30-4b65-981d-366fa6002a67",
      "name": "Get New Workflow Hash",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        208,
        -816
      ],
      "typeVersion": 1.2,
      "alwaysOutputData": false,
      "disabled": true
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "mode": "list",
          "value": "U7Jh9njKLEjGLVIl",
          "cachedResultName": "n8n Backup Changes"
        },
        "workflowInputs": {
          "value": {
            "filePath": "={{ $('Set Workflow Path').item.json.filePath }}"
          },
          "schema": [
            {
              "id": "filePath",
              "type": "string",
              "display": true,
              "removed": false,
              "required": false,
              "displayName": "filePath",
              "defaultMatch": false,
              "canBeUsedToMatch": true
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "filePath"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "id": "e771eec6-80bd-4aa7-8d44-3843535de50e",
      "name": "Get Old Workflow Hash",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        -224,
        -816
      ],
      "typeVersion": 1.2,
      "alwaysOutputData": true,
      "disabled": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "fileSelector": "={{ $('Set Workflow Path').item.json.filePath }}",
        "options": {}
      },
      "id": "4e08a0de-e733-48a4-bfb3-0a3ff5f88e23",
      "name": "Read Workflow Data",
      "type": "n8n-nodes-base.readWriteFile",
      "position": [
        656,
        -816
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c60cce2a-609d-417e-a73c-9719a490cc85",
              "name": "filePath",
              "type": "string",
              "value": "/data/shared/WorkFlowBackup.json"
            }
          ]
        },
        "options": {}
      },
      "id": "23cecdbb-0563-4a8b-83d2-92c12ada45e8",
      "name": "Set Workflow Path",
      "type": "n8n-nodes-base.set",
      "position": [
        -448,
        -816
      ],
      "typeVersion": 3.4,
      "disabled": true
    },
    {
      "parameters": {
        "command": "=n8n export:workflow --all --output={{ $('Set Workflow Path').item.json.filePath }}"
      },
      "id": "a05d5793-b035-4734-a648-e2e817050246",
      "name": "Execute Workflow Backup",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        -16,
        -816
      ],
      "typeVersion": 1,
      "alwaysOutputData": true,
      "disabled": true
    },
    {
      "parameters": {
        "fileSelector": "={{ $json.filePath }}",
        "options": {}
      },
      "id": "306ee496-bd41-498c-b58b-b5b53447d0ec",
      "name": "Read File",
      "type": "n8n-nodes-base.readWriteFile",
      "position": [
        288,
        -208
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "id": "c912ab9f-c3f9-4233-97a8-f30b0cd6f88e",
      "name": "Extract Data",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        512,
        -208
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "type": "SHA256",
        "value": "={{$json.data}}",
        "dataPropertyName": "hash"
      },
      "id": "65f469f4-e63a-4b00-9a4c-af0bc1778248",
      "name": "Hash Data",
      "type": "n8n-nodes-base.crypto",
      "position": [
        720,
        -208
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "workflowInputs": {
          "values": [
            {
              "name": "filePath"
            }
          ]
        }
      },
      "id": "7bcf05ea-5780-4724-b5bb-84e525e3b169",
      "name": "Hash Maker",
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "position": [
        64,
        -208
      ],
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "id": "7b51b298-61e2-4372-b6d6-f31efe6088d4",
      "name": "Extract Workflow Data",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        880,
        -816
      ],
      "typeVersion": 1,
      "disabled": true
    },
    {
      "parameters": {
        "resource": "file",
        "owner": {
          "__rl": true,
          "value": "https://github.com/nathankwok",
          "mode": "url"
        },
        "repository": {
          "__rl": true,
          "value": "https://github.com/nathankwok/n8n_workflows",
          "mode": "url"
        },
        "filePath": "={{ \"backups/WorkFlow Backup \" + new Date($now).toISOString().replace('T', ' ').slice(0, 16) + \".json\" }}",
        "fileContent": "={{ $json.data }}",
        "commitMessage": "={{ \"WorkFlow Backup \" + new Date($now).toISOString().replace('T', ' ').slice(0, 16) }}"
      },
      "id": "f4c9414a-2ca3-4b44-ade3-e5de1ad2bbd5",
      "name": "GitHub Workflow Backup",
      "type": "n8n-nodes-base.github",
      "position": [
        1104,
        -816
      ],
      "webhookId": "ccf2ad35-62aa-4e3e-9811-ea6d7fca0aba",
      "typeVersion": 1.1,
      "credentials": {
        "githubApi": {
          "id": "KBH9KG8I0VZ6x3LD",
          "name": "GitHub account"
        }
      },
      "disabled": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "aWQxKVUGIdQdrcGd",
          "mode": "list",
          "cachedResultName": "Backup_Credentials"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "filePath": "={{ $('Global Vars').item.json.local.credentials_file_path }}"
          },
          "matchingColumns": [
            "filePath"
          ],
          "schema": [
            {
              "id": "filePath",
              "displayName": "filePath",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "id": "b6a2d34e-247e-42ee-a5a9-5acbf2b4ae3c",
      "name": "Get New Credential Hash",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        576,
        496
      ],
      "typeVersion": 1.2,
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "aWQxKVUGIdQdrcGd",
          "mode": "list",
          "cachedResultName": "Backup_Credentials"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "filePath": "={{ $('Global Vars').item.json.local.credentials_file_path }}"
          },
          "matchingColumns": [
            "filePath"
          ],
          "schema": [
            {
              "id": "filePath",
              "displayName": "filePath",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "id": "86e86739-b7ce-4aa7-9fa2-219236fac893",
      "name": "Get Old Credential Hash",
      "type": "n8n-nodes-base.executeWorkflow",
      "position": [
        144,
        496
      ],
      "typeVersion": 1.2,
      "alwaysOutputData": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "fileSelector": "={{ $('Global Vars').item.json.local.credentials_file_path }}",
        "options": {}
      },
      "id": "2e8c23e9-954f-4d1f-9922-ab18457bf2d3",
      "name": "Read Credential Data",
      "type": "n8n-nodes-base.readWriteFile",
      "position": [
        1024,
        496
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "command": "=n8n export:credentials --all --output={{ $('Global Vars').item.json.local.credentials_file_path }}"
      },
      "id": "f46fc0b4-cfa6-4e41-8044-bd03a016372d",
      "name": "Execute Credential Backup",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        352,
        496
      ],
      "typeVersion": 1,
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "operation": "text",
        "options": {}
      },
      "id": "91e6fe48-cfee-4a3f-a5b1-57b45258bfc8",
      "name": "Extract Credential Data",
      "type": "n8n-nodes-base.extractFromFile",
      "position": [
        1248,
        496
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "resource": "file",
        "operation": "edit",
        "owner": {
          "__rl": true,
          "value": "=https://github.com/{{ $('Global Vars').item.json.repo.owner }}",
          "mode": "url"
        },
        "repository": {
          "__rl": true,
          "value": "=https://github.com/{{ $('Global Vars').item.json.repo.owner }}/{{ $('Global Vars').item.json.repo.name }}",
          "mode": "url"
        },
        "filePath": "={{ $('Global Vars').item.json.repo.credentials_file_path }}",
        "fileContent": "={{ $json.data }}",
        "commitMessage": "={{ \"Credential Backup \" + new Date($today).toISOString().replace('T', ' ').slice(0, 16) }}"
      },
      "id": "063384ef-6f4c-4a70-ae9f-b443a13c3184",
      "name": "GitHub Credential Backup",
      "type": "n8n-nodes-base.github",
      "position": [
        1472,
        496
      ],
      "webhookId": "ccf2ad35-62aa-4e3e-9811-ea6d7fca0aba",
      "typeVersion": 1.1,
      "credentials": {
        "githubApi": {
          "id": "KBH9KG8I0VZ6x3LD",
          "name": "GitHub account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "combinator": "and",
          "conditions": [
            {
              "id": "c028ce1d-3fe9-4dc9-a3e9-296460e12c83",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              },
              "leftValue": "={{ $('Get New Workflow Hash').item.json.hash }}",
              "rightValue": "={{ $('Get Old Workflow Hash').item.json.hash }}"
            }
          ]
        },
        "options": {}
      },
      "id": "73586425-0ffa-44f5-93f0-fae63b06aa04",
      "name": "If Workflow Updated",
      "type": "n8n-nodes-base.if",
      "position": [
        432,
        -816
      ],
      "typeVersion": 2.2,
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "1544d2a4-a940-4f33-a084-d069f498acb2",
              "leftValue": "={{ $('Get Old Credential Hash').item.json }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "empty",
                "singleValue": true
              }
            },
            {
              "id": "c028ce1d-3fe9-4dc9-a3e9-296460e12c83",
              "operator": {
                "type": "string",
                "operation": "notEquals"
              },
              "leftValue": "={{ $('Get New Credential Hash').item.json.hash }}",
              "rightValue": "={{ $('Get Old Credential Hash').item.json.hash }}"
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "id": "40cba181-8f0c-49ae-a6d9-9aba2794e9b3",
      "name": "If Credential Updated",
      "type": "n8n-nodes-base.if",
      "position": [
        800,
        496
      ],
      "typeVersion": 2.2,
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "cfc37a45-8394-4c8f-beef-cdfc7a38c988",
              "name": "repo.owner",
              "value": "nathankwok",
              "type": "string"
            },
            {
              "id": "0081ae3b-12f2-49d4-b327-57c1af3416a8",
              "name": "repo.name",
              "value": "n8n_workflows",
              "type": "string"
            },
            {
              "id": "0e5c64e2-af02-488c-b63e-5bbc652a662f",
              "name": "repo.credentials_file_path",
              "value": "credentials/credentials.json",
              "type": "string"
            },
            {
              "id": "e06f8bff-8450-49fc-8fa5-06d69109b1ec",
              "name": "local.credentials_file_path",
              "value": "credentials/credentials.json",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -688,
        320
      ],
      "id": "e21c2079-2802-4d8b-937d-90b17dd4b038",
      "name": "Global Vars"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "c4629850-428f-43e6-87e5-e74bb5bb1462",
              "leftValue": "={{ $json.stdout }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -240,
        320
      ],
      "id": "38885d66-2b2c-442c-bb2c-c8d467657041",
      "name": "If"
    },
    {
      "parameters": {
        "command": "=[ -e \"{{ $json.local.credentials_file_path }}\" ] && echo true || echo false"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -480,
        320
      ],
      "id": "7c523b50-ca1c-4614-a23f-5651917f6563",
      "name": "Is credentials file exist"
    },
    {
      "parameters": {
        "command": "=n8n export:credentials --all --output={{ $('Global Vars').item.json.local.credentials_file_path }}"
      },
      "id": "7fda4b16-c6e1-4c66-9a3d-19c93cd8ede7",
      "name": "Execute Credential Backup1",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        352,
        224
      ],
      "typeVersion": 1,
      "alwaysOutputData": true
    },
    {
      "parameters": {
        "content": "If an old credentials file exists, then check if updated. \nIf no credentials file exists, then generate one and upload.",
        "height": 128,
        "width": 224
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -288,
        144
      ],
      "typeVersion": 1,
      "id": "4b83f8ae-a0cc-41c8-af5e-4cfa0e4ce27d",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "Bypass checks if no old credentials file exists.",
        "height": 96,
        "width": 192
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        288,
        96
      ],
      "typeVersion": 1,
      "id": "b2ac07b8-7281-423a-96b3-28214359c79d",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "command": "echo \"No changes to credentials file. Exiting without uploading credentials file to GitHub.\""
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        1008,
        800
      ],
      "id": "801b8520-17d1-43e1-9ab7-18ec6a56e31f",
      "name": "Execute Command"
    }
  ],
  "connections": {
    "Read File": {
      "main": [
        [
          {
            "node": "Extract Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Hash Maker": {
      "main": [
        [
          {
            "node": "Read File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Data": {
      "main": [
        [
          {
            "node": "Hash Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Set Workflow Path",
            "type": "main",
            "index": 0
          },
          {
            "node": "Global Vars",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Workflow Path": {
      "main": [
        [
          {
            "node": "Get Old Workflow Hash",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Workflow Data": {
      "main": [
        [
          {
            "node": "Extract Workflow Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Workflow Updated": {
      "main": [
        [
          {
            "node": "Read Workflow Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Credential Data": {
      "main": [
        [
          {
            "node": "Extract Credential Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Workflow Data": {
      "main": [
        [
          {
            "node": "GitHub Workflow Backup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get New Workflow Hash": {
      "main": [
        [
          {
            "node": "If Workflow Updated",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Old Workflow Hash": {
      "main": [
        [
          {
            "node": "Execute Workflow Backup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If Credential Updated": {
      "main": [
        [
          {
            "node": "Read Credential Data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Execute Command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Workflow Backup": {
      "main": [
        [
          {
            "node": "Get New Workflow Hash",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Credential Data": {
      "main": [
        [
          {
            "node": "GitHub Credential Backup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get New Credential Hash": {
      "main": [
        [
          {
            "node": "If Credential Updated",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Old Credential Hash": {
      "main": [
        [
          {
            "node": "Execute Credential Backup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Credential Backup": {
      "main": [
        [
          {
            "node": "Get New Credential Hash",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Global Vars": {
      "main": [
        [
          {
            "node": "Is credentials file exist",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Get Old Credential Hash",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Execute Credential Backup1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is credentials file exist": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute Credential Backup1": {
      "main": [
        [
          {
            "node": "Read Credential Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": []
    }
  },
  "meta": null,
  "pinData": {},
  "versionId": "f5a51a68-fcfb-45ef-9fb1-5873e5a61c0c",
  "triggerCount": 1,
  "shared": [
    {
      "createdAt": "2025-08-16T19:58:14.381Z",
      "updatedAt": "2025-08-16T19:58:14.381Z",
      "role": "workflow:owner",
      "workflowId": "aWQxKVUGIdQdrcGd",
      "projectId": "w7JTueqTYNrmBYZn"
    }
  ],
  "tags": []
}