{
  "updatedAt": "2026-01-27T11:46:10.497Z",
  "createdAt": "2025-12-20T02:14:15.837Z",
  "id": "4cCsYYYaNoTNWB3U",
  "name": "Board_Deck_Takeaways",
  "active": true,
  "isArchived": false,
  "nodes": [
    {
      "parameters": {},
      "id": "trigger1",
      "name": "When clicking 'Execute workflow'",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        224,
        1120
      ],
      "disabled": true
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{\n  \"dashboard_discovery_model_version\": \"1.0\",\n  \"snowflake_base_url\": \"https://ml16699-hya89079.snowflakecomputing.com\",\n  \"omni_documents_search_service\": {\n    \"snowflake_database\": \"ANALYTICS\",\n    \"snowflake_schema\": \"OMNI\",\n    \"service_name\": \"omni_documents_search_service\"\n  },\n  \"omni_api\": {\n    \"omni_base_url\": \"https://cribl.omniapp.co\",\n    \"model_id\": \"4345b118-cbbe-4f7c-a705-ea0aa8da57c0\"\n  },\n  \"snowflake_tables\": {\n    \"omni_documents\": {\n      \"snowflake_database\": \"ANALYTICS\",\n      \"snowflake_schema\": \"OMNI\",\n      \"table_name\": \"DOCUMENTS\"\n    },\n    \"dashboard_recommendations\": {\n      \"snowflake_database\": \"RAW\",\n      \"snowflake_schema\": \"OMNI\",\n      \"table_name\": \"DASHBOARD_RECOMMENDATIONS\"\n    }\n  },\n  \"default_user_id\": \"893ce348-0fb2-44ac-b0f8-06521a341580\"\n}",
        "includeOtherFields": true,
        "include": "except",
        "excludeFields": "headers,params,query,webhookUrl,executionMode",
        "options": {}
      },
      "id": "globalVars1",
      "name": "Global Vars",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        832,
        1120
      ]
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "{\n  \"b5c07e22-63a7-4c39-b4e1-39fed0467998\": [\n    {\n      \"document_query_name\": \"Q3 Won & Q4 Open_Stream\",\n      \"drill_name\": \"stream_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [],\n        \"table\": \"sales__opportunity\",\n        \"fields\": [\n          \"sales__accounts.account_name\",\n          \"sales__opportunity.opportunity_name\",\n          \"sales__accounts.owner_name\",\n          \"sales__opportunity.forecast\",\n          \"sales__opportunity.stage_name\",\n          \"sales__opportunity.record_type\",\n          \"sales__opportunity.new_arr_derived\",\n          \"sales__opportunity.close_date\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"sales__opportunity.close_date\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2027 Q1\"\n              },\n              {\n                \"type\": \"composite\",\n                \"filters\": [\n                  {\n                    \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                    \"type\": \"date\",\n                    \"left_side\": \"2 complete fiscal quarters ago\",\n                    \"right_side\": \"2 quarters\",\n                    \"is_negative\": false\n                  },\n                  {\n                    \"kind\": \"BETWEEN\",\n                    \"type\": \"date\",\n                    \"left_side\": \"0 fiscal quarters ago\",\n                    \"right_side\": \"2 fiscal quarters from now\",\n                    \"is_negative\": false\n                  }\n                ],\n                \"conjunction\": \"OR\"\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"sales__opportunity.stage_name\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"3. Visible Opportunity\"\n            ]\n          },\n          \"sales__opportunity.type_of_opp\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"Downsell\",\n              \"NFR\",\n              \"Services Only\"\n            ],\n            \"is_negative\": true\n          },\n          \"sales__opportunity.stage_last_updated\": {\n            \"kind\": \"BEFORE\",\n            \"type\": \"date\",\n            \"right_side\": \"2025-11-03\",\n            \"is_negative\": false\n          }\n        },\n        \"modelId\": \"ff7d6a64-3403-4b84-922d-e8ac1382baf5\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"opportunity\"\n      }\n    }\n  ]\n}",
        "includeOtherFields": true,
        "options": {}
      },
      "id": "loadQueries1",
      "name": "Load Drill Queries",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2064,
        1120
      ]
    },
    {
      "parameters": {
        "options": {
          "reset": false
        }
      },
      "id": "outerLoop1",
      "name": "Loop Over UUIDs",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        3152,
        1120
      ],
      "executeOnce": false
    },
    {
      "parameters": {
        "jsCode": "const inputData = $('Load Drill Queries').first().json;\n  const systemFields = ['headers', 'params', 'query', 'webhookUrl', 'executionMode'];\n  const drillQueries = {};\n\n  for (const [key, value] of Object.entries(inputData)) {\n    if (!systemFields.includes(key) && typeof value === 'object' && Array.isArray(value)) {\n      drillQueries[key] = value;\n    }\n  }\n\n  const uuidKeys = Object.keys(drillQueries);\n\n  if (uuidKeys.length === 0) {\n    return [{\n      json: {\n        error: 'No drill query UUIDs found in input data',\n        inputKeys: Object.keys(inputData)\n      }\n    }];\n  }\n\n  let drill_queries = uuidKeys.map(document_query_id => ({\n    json: {\n      document_query_id: document_query_id,\n      document_query_name: drillQueries[document_query_id][0][\"document_query_name\"],\n      queries: drillQueries[document_query_id],\n      queryCount: drillQueries[document_query_id].length\n    }\n  }))\n\n  return drill_queries;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2656,
        1120
      ],
      "id": "d9071922-dd3c-4544-8313-87cd21b0b593",
      "name": "Prepare UUID Loop Data"
    },
    {
      "parameters": {
        "jsCode": "const inputData = $('Load Drill Queries').first().json;\n  const systemFields = ['headers', 'params', 'query', 'webhookUrl', 'executionMode'];\n  const drillQueries = {};\n\n  for (const [key, value] of Object.entries(inputData)) {\n    if (!systemFields.includes(key) && typeof value === 'object' && Array.isArray(value)) {\n      drillQueries[key] = value;\n    }\n  }\n\n  const uuidKeys = Object.keys(drillQueries);\n\n  if (uuidKeys.length === 0) {\n    return [{\n      json: {\n        error: 'No drill query UUIDs found in input data',\n        inputKeys: Object.keys(inputData)\n      }\n    }];\n  }\n\n  let count = 0;\n  uuidKeys.forEach(uuid => count += drillQueries[uuid].length);\n\n  return {\n    \"drill_queries_count\": count\n  };"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2352,
        1120
      ],
      "id": "347e89ad-1d53-4099-8d9d-20a8602b2c12",
      "name": "Get Drill Queries Count"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"today\": \"2026-02-22\",\n  \"current_fiscal_quarter\": \"FY2027 Q1\",\n  \"previous_fiscal_quarter\": \"FY2026 Q4\",\n  \"current_fiscal_half\": \"FY2027 H1\",\n  \"previous_fiscal_half\": \"FY2026 H2\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        1296,
        1328
      ],
      "id": "0f55f706-a159-4c68-bb74-68f7dbe15efe",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=<role>\nYou are a date-aware automation agent that, at runtime, uses the current calendar date and converts it into the organization’s fiscal quarter and fiscal half-year.\n</role>\n\n<task>\n1. Capture today’s date in ISO-8601 format (YYYY-MM-DD).  \n2. Derive the current fiscal quarter using this mapping:  \n   • February, March, April → Q1  \n   • May, June, July → Q2  \n   • August, September, October → Q3  \n   • November, December, January → Q4\n3. Similarly, derive the previous fiscal quarter.\n4. Then, derive the previous' previous fiscal quarter. In the end, you will have 3 fiscal quarters. From here on out, you will consider the \"current_fiscal_quarter\" to be your derived previous fiscal quarter and you will consider the \"previous_fiscal_quarter\" to be your derived 2 quarters previous. This is because we will run this at the end of each quarter that has just finished in order to compare this most recently finished fiscal quarter with 2 quarters ago.\n4. Determine the current fiscal half-year: \n   • H1 = Q1 + Q2 (February – July) \n   • H2 = Q3 + Q4 (August – January)\n5. Similarly to deriving the current fiscal half-year, derive the previous fiscal half-year\n6. Assign the fiscal year (FY):  \n   • FY is labelled by the calendar year of the January that closes Q4.  \n     – Example: any date from 2025-11-01 through 2026-01-31 belongs to FY2026 Q4.  \n7. If a month is ever missing from the mapping (unexpected), set  \n   \"fiscal_quarter\": \"Unmapped\", \"fiscal_half\": \"Unmapped\",  \n   add a \"warning\" key explaining why, and continue.  \n8. Produce one JSON object that follows the output_format section exactly.  \n9. Self-check: validate JSON syntax, confirm quarter/half/year logic, and flag any ambiguity or edge case before returning.\n</task>\n\n<context>\nThe organization follows a non-standard fiscal calendar that begins in February and spans ten active months, grouping them into the quarters above.  \nWe prefer the simplest workflow that fully handles edge cases (e.g., leap years, timezone differences, cross-year FY labelling) and follows security-best practices.\n</context>\n\n<examples>\n<fiscal_quarter_examples>\n2024-02-01 → FY2025 Q1  \n2024-05-15 → FY2025 Q2\n2024-07-29 → FY2025 Q2\n2024-08-01 → FY2025 Q3\n2024-10-30 → FY2025 Q3\n2024-12-30 → FY2025 Q4  \n2025-01-31 → FY2025 Q4\n2025-02-01 → FY2026 Q1\n2025-06-10 → FY2026 Q2  \n2025-09-05 → FY2026 Q3  \n2025-12-12 → FY2026 Q4  \n2026-03-03 → FY2027 Q1\n2026-05-22 → FY2027 Q2\n</fiscal_quarter_examples>\n\n<fiscal_half_examples>\n2024-02-01 → FY2025 H1\n2024-05-15 → FY2025 H1\n2024-07-29 → FY2025 H1\n2024-08-01 → FY2025 H2\n2024-10-30 → FY2025 H2\n2024-12-30 → FY2025 H2  \n2025-01-31 → FY2025 H2  \n2025-02-01 → FY2026 H1\n2025-06-10 → FY2026 H1  \n2025-09-05 → FY2026 H2  \n2025-12-12 → FY2026 H2  \n2026-03-03 → FY2027 H1\n2026-05-22 → FY2027 H1\n</fiscal_half_examples>\n\n</examples>\n\n<guidelines>\n- Output only the JSON object—no extra text.  \n- Keys must be lower_snake_case and wrapped in double quotes.  \n- Do not include trailing commas.  \n- Point out any implicit or non-obvious “gotchas” (e.g., FY roll-over rules) in the \"warning\" field instead of silently proceeding.  \n- Do not simply agree; highlight anything incorrect or sub-optimal and suggest improvements.  \n- Think step-by-step, then self-check that the response meets every instruction before returning it.\n</guidelines>\n\n<input>\ntoday: {{ $today.format('yyyy-MM-dd') }}\n</input>\n\n<output_format>\n{\n  \"today\": \"2026-05-22\",\n  \"current_fiscal_quarter\": \"FY2027 Q1\",\n  \"previous_fiscal_quarter\": \"FY2026 Q4\",\n  \"current_fiscal_half\": \"FY2027 H1\",\n  \"previous_fiscal_half\": \"FY2026 H2\"\n}\n</output_format>",
        "hasOutputParser": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        1136,
        1120
      ],
      "id": "627f6fd7-713f-44fe-8a43-511b655cf548",
      "name": "Fiscal Quarter Extractor"
    },
    {
      "parameters": {
        "model": "o4-mini",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
      "typeVersion": 1,
      "position": [
        1120,
        1328
      ],
      "id": "5421085b-5efc-40de-895d-5f9d003d2ddf",
      "name": "o4-mini",
      "credentials": {
        "azureOpenAiApi": {
          "id": "N96DE6AiByL8h8kA",
          "name": "Azure OpenAI o4-mini"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "board-deck-takeaways-ze5ubv1w",
        "authentication": "basicAuth",
        "responseMode": "responseNode",
        "options": {
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        224,
        1392
      ],
      "id": "6ed5e716-a593-43f8-a2a5-ff2b55e7606a",
      "name": "Trigger",
      "webhookId": "1298ec1c-5d6c-4010-9b21-b40fada0aa39",
      "alwaysOutputData": true,
      "credentials": {
        "httpBasicAuth": {
          "id": "3AVUqEU99hkVKUOW",
          "name": "Zapier Inbound Basic Auth Webhook"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "noData",
        "options": {
          "responseCode": 202
        }
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.5,
      "position": [
        480,
        1392
      ],
      "id": "ee9d858a-7473-476a-8e2d-509ceb132fb6",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "=Board_Deck_Takeaways_{{ $now.format('yyyyMMdd_HHmmss') }}",
        "driveId": {
          "__rl": true,
          "value": "My Drive",
          "mode": "list",
          "cachedResultName": "My Drive",
          "cachedResultUrl": "https://drive.google.com/drive/my-drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1dSd5PWJ0BH1ksydt-GnYJraDhwLnAbGZ",
          "mode": "list",
          "cachedResultName": "AI Workflow - Board Deck Takeaways",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1dSd5PWJ0BH1ksydt-GnYJraDhwLnAbGZ"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1600,
        1120
      ],
      "id": "15d9460c-b80f-4f00-9421-f1073c6e8a94",
      "name": "Create folder",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "SgST8lxFUWMslYat",
          "name": "Google Drive Cribl"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fa236bc3-f105-4270-adb5-2552a04a69e5",
              "name": "google_drive_folder_id",
              "value": "={{ $('Create folder').item.json.id }}",
              "type": "string"
            },
            {
              "id": "230fa6da-2b61-420f-b2d7-10d6cacf6c5d",
              "name": "current_fiscal_quarter",
              "value": "={{ $('Fiscal Quarter Extractor').item.json.output.current_fiscal_quarter }}",
              "type": "string"
            },
            {
              "id": "b0c57526-3be8-49d0-8967-0af6a965063d",
              "name": "previous_fiscal_quarter",
              "value": "={{ $('Fiscal Quarter Extractor').item.json.output.previous_fiscal_quarter }}",
              "type": "string"
            },
            {
              "id": "80a8a4e9-2554-474e-aada-25bfdbddb519",
              "name": "default_user_id",
              "value": "={{ $('Global Vars').item.json.default_user_id }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3424,
        1280
      ],
      "id": "2644febc-6619-4de2-ac6c-b17278e1c02d",
      "name": "Loop UUID Item"
    },
    {
      "parameters": {
        "content": "- No matter how many drill query sort versions that a drill query has, this loop (which goes for each drill query) should only still input one takeaway per drill query"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        6528,
        2048
      ],
      "typeVersion": 1,
      "id": "6c326fa0-6fd2-4005-ab4b-69c5de620beb",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "- No matter how many drill queries (and thus drill query sort versions) that a document query has, this loop (which goes for each document query/chart) should only still create one google doc within the folder per document query",
        "height": 208
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        4784,
        1760
      ],
      "typeVersion": 1,
      "id": "8dc7f025-9cef-4f86-9278-e4d352662333",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "mDJHNy6DrprAll2W",
          "mode": "list",
          "cachedResultUrl": "/workflow/mDJHNy6DrprAll2W",
          "cachedResultName": "Board_Deck_Document_Query_Analysis_Subworkflow"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "input": "={{ $json }}"
          },
          "matchingColumns": [
            "input"
          ],
          "schema": [
            {
              "id": "input",
              "displayName": "input",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "object",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {
          "waitForSubWorkflow": false
        }
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.3,
      "position": [
        3632,
        1280
      ],
      "id": "0d71b9a5-7d56-4e33-92f6-ccc9a2216c29",
      "name": "Call 'Board_Deck_Document_Query_Analysis_Subworkflow'"
    },
    {
      "parameters": {
        "content": "## High number of measures\n```\n{\n  \"c3023df3-39f1-4913-86c8-07d69f6caeb1\": [\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_customers\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.customer_type\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\",\n          \"finance__customer_quarterly_arr.total_churn_arr\",\n          \"finance__customer_quarterly_arr.total_downsell_arr\",\n          \"finance__customer_quarterly_arr.total_ending_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"e3a78095-f13c-49a2-9a4c-617fca386ca4\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    \\\"CUSTOMER_TYPE\\\" AS \\\"finance__customer_quarterly_arr.customer_type\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"CHURN_ARR\\\" < 0 THEN \\\"CHURN_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_churn_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"DOWNSELL_ARR\\\" < 0 THEN \\\"DOWNSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_downsell_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"ENDING_ARR\\\" > 0 THEN \\\"ENDING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_ending_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 5, 3, 1\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_migration_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.customer_type\",\n          \"finance__customer_quarterly_arr.total_migration_arr\",\n          \"finance__customer_quarterly_arr.migration_arr_cloud\",\n          \"finance__customer_quarterly_arr.migration_arr_software\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"df073f20-17b0-4d9c-b667-2b2f86b5fae8\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    \\\"CUSTOMER_TYPE\\\" AS \\\"finance__customer_quarterly_arr.customer_type\\\",\\n    COALESCE(SUM(\\\"MIGRATION_ARR_CLOUD\\\"), 0) AS \\\"finance__customer_quarterly_arr.total_migration_arr\\\",\\n    \\\"MIGRATION_ARR_CLOUD\\\" AS \\\"finance__customer_quarterly_arr.migration_arr_cloud\\\",\\n    \\\"MIGRATION_ARR_SOFTWARE\\\" AS \\\"finance__customer_quarterly_arr.migration_arr_software\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 5, 3, 1, 7, 8\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_gross_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [\n          {\n            \"column_name\": \"finance__customer_quarterly_arr.total_starting_arr\",\n            \"sort_descending\": true\n          }\n        ],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"51b818b3-a897-4ede-a516-ab7436c6be97\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 3, 1\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_gross_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [\n          {\n            \"column_name\": \"finance__customer_quarterly_arr.total_new_arr\",\n            \"sort_descending\": true\n          }\n        ],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"51b818b3-a897-4ede-a516-ab7436c6be97\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 3, 1\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_gross_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [\n          {\n            \"column_name\": \"finance__customer_quarterly_arr.total_upsell_arr\",\n            \"sort_descending\": true\n          }\n        ],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"51b818b3-a897-4ede-a516-ab7436c6be97\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 3, 1\\nLIMIT 1000\"\n    }\n  ]\n}\n```"
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2000,
        784
      ],
      "typeVersion": 1,
      "id": "15463490-f48d-43c9-acaf-f0700a88a72a",
      "name": "Sticky Note"
    }
  ],
  "connections": {
    "When clicking 'Execute workflow'": {
      "main": [
        [
          {
            "node": "Global Vars",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Global Vars": {
      "main": [
        [
          {
            "node": "Fiscal Quarter Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Load Drill Queries": {
      "main": [
        [
          {
            "node": "Get Drill Queries Count",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over UUIDs": {
      "main": [
        [],
        [
          {
            "node": "Loop UUID Item",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare UUID Loop Data": {
      "main": [
        [
          {
            "node": "Loop Over UUIDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Drill Queries Count": {
      "main": [
        [
          {
            "node": "Prepare UUID Loop Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Fiscal Quarter Extractor",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Fiscal Quarter Extractor": {
      "main": [
        [
          {
            "node": "Create folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "o4-mini": {
      "ai_languageModel": [
        [
          {
            "node": "Fiscal Quarter Extractor",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Trigger": {
      "main": [
        [
          {
            "node": "Respond to Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Webhook": {
      "main": [
        [
          {
            "node": "Global Vars",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder": {
      "main": [
        [
          {
            "node": "Load Drill Queries",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop UUID Item": {
      "main": [
        [
          {
            "node": "Call 'Board_Deck_Document_Query_Analysis_Subworkflow'",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call 'Board_Deck_Document_Query_Analysis_Subworkflow'": {
      "main": [
        [
          {
            "node": "Loop Over UUIDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false
  },
  "staticData": null,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "pinData": {
    "Trigger": [
      {
        "json": {
          "name": "First item",
          "code": 1
        }
      }
    ],
    "Fiscal Quarter Extractor": [
      {
        "json": {
          "output": {
            "today": "2026-01-23",
            "current_fiscal_quarter": "FY2026 Q3",
            "previous_fiscal_quarter": "FY2026 Q2",
            "current_fiscal_half": "FY2026 H2",
            "previous_fiscal_half": "FY2026 H1"
          }
        },
        "pairedItem": {
          "item": 0
        }
      }
    ],
    "Create folder": [
      {
        "json": {
          "kind": "drive#file",
          "id": "1i-Q0pCIIHsMtRC1GelGp1mTdrTa777MZ",
          "name": "Board_Deck_Takeaways_20260123_182411",
          "mimeType": "application/vnd.google-apps.folder"
        },
        "pairedItem": {
          "item": 0
        }
      }
    ]
  },
  "versionId": "5a905ecc-a8fc-464d-85e4-831df6008dcd",
  "activeVersionId": "5a905ecc-a8fc-464d-85e4-831df6008dcd",
  "triggerCount": 1,
  "shared": [
    {
      "updatedAt": "2025-12-20T02:14:15.842Z",
      "createdAt": "2025-12-20T02:14:15.842Z",
      "role": "workflow:owner",
      "workflowId": "4cCsYYYaNoTNWB3U",
      "projectId": "2vHf2VxAoKk0WgJE"
    }
  ],
  "activeVersion": {
    "updatedAt": "2026-01-27T11:46:10.498Z",
    "createdAt": "2026-01-27T11:46:10.498Z",
    "versionId": "5a905ecc-a8fc-464d-85e4-831df6008dcd",
    "workflowId": "4cCsYYYaNoTNWB3U",
    "nodes": [
      {
        "parameters": {},
        "id": "trigger1",
        "name": "When clicking 'Execute workflow'",
        "type": "n8n-nodes-base.manualTrigger",
        "typeVersion": 1,
        "position": [
          224,
          1120
        ],
        "disabled": true
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n  \"dashboard_discovery_model_version\": \"1.0\",\n  \"snowflake_base_url\": \"https://ml16699-hya89079.snowflakecomputing.com\",\n  \"omni_documents_search_service\": {\n    \"snowflake_database\": \"ANALYTICS\",\n    \"snowflake_schema\": \"OMNI\",\n    \"service_name\": \"omni_documents_search_service\"\n  },\n  \"omni_api\": {\n    \"omni_base_url\": \"https://cribl.omniapp.co\",\n    \"model_id\": \"4345b118-cbbe-4f7c-a705-ea0aa8da57c0\"\n  },\n  \"snowflake_tables\": {\n    \"omni_documents\": {\n      \"snowflake_database\": \"ANALYTICS\",\n      \"snowflake_schema\": \"OMNI\",\n      \"table_name\": \"DOCUMENTS\"\n    },\n    \"dashboard_recommendations\": {\n      \"snowflake_database\": \"RAW\",\n      \"snowflake_schema\": \"OMNI\",\n      \"table_name\": \"DASHBOARD_RECOMMENDATIONS\"\n    }\n  },\n  \"default_user_id\": \"893ce348-0fb2-44ac-b0f8-06521a341580\"\n}",
          "includeOtherFields": true,
          "include": "except",
          "excludeFields": "headers,params,query,webhookUrl,executionMode",
          "options": {}
        },
        "id": "globalVars1",
        "name": "Global Vars",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          832,
          1120
        ]
      },
      {
        "parameters": {
          "mode": "raw",
          "jsonOutput": "{\n  \"b5c07e22-63a7-4c39-b4e1-39fed0467998\": [\n    {\n      \"document_query_name\": \"Q3 Won & Q4 Open_Stream\",\n      \"drill_name\": \"stream_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [],\n        \"table\": \"sales__opportunity\",\n        \"fields\": [\n          \"sales__accounts.account_name\",\n          \"sales__opportunity.opportunity_name\",\n          \"sales__accounts.owner_name\",\n          \"sales__opportunity.forecast\",\n          \"sales__opportunity.stage_name\",\n          \"sales__opportunity.record_type\",\n          \"sales__opportunity.new_arr_derived\",\n          \"sales__opportunity.close_date\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"sales__opportunity.close_date\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2027 Q1\"\n              },\n              {\n                \"type\": \"composite\",\n                \"filters\": [\n                  {\n                    \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                    \"type\": \"date\",\n                    \"left_side\": \"2 complete fiscal quarters ago\",\n                    \"right_side\": \"2 quarters\",\n                    \"is_negative\": false\n                  },\n                  {\n                    \"kind\": \"BETWEEN\",\n                    \"type\": \"date\",\n                    \"left_side\": \"0 fiscal quarters ago\",\n                    \"right_side\": \"2 fiscal quarters from now\",\n                    \"is_negative\": false\n                  }\n                ],\n                \"conjunction\": \"OR\"\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"sales__opportunity.stage_name\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"3. Visible Opportunity\"\n            ]\n          },\n          \"sales__opportunity.type_of_opp\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"Downsell\",\n              \"NFR\",\n              \"Services Only\"\n            ],\n            \"is_negative\": true\n          },\n          \"sales__opportunity.stage_last_updated\": {\n            \"kind\": \"BEFORE\",\n            \"type\": \"date\",\n            \"right_side\": \"2025-11-03\",\n            \"is_negative\": false\n          }\n        },\n        \"modelId\": \"ff7d6a64-3403-4b84-922d-e8ac1382baf5\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"opportunity\"\n      }\n    }\n  ]\n}",
          "includeOtherFields": true,
          "options": {}
        },
        "id": "loadQueries1",
        "name": "Load Drill Queries",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2064,
          1120
        ]
      },
      {
        "parameters": {
          "options": {
            "reset": false
          }
        },
        "id": "outerLoop1",
        "name": "Loop Over UUIDs",
        "type": "n8n-nodes-base.splitInBatches",
        "typeVersion": 3,
        "position": [
          3152,
          1120
        ],
        "executeOnce": false
      },
      {
        "parameters": {
          "jsCode": "const inputData = $('Load Drill Queries').first().json;\n  const systemFields = ['headers', 'params', 'query', 'webhookUrl', 'executionMode'];\n  const drillQueries = {};\n\n  for (const [key, value] of Object.entries(inputData)) {\n    if (!systemFields.includes(key) && typeof value === 'object' && Array.isArray(value)) {\n      drillQueries[key] = value;\n    }\n  }\n\n  const uuidKeys = Object.keys(drillQueries);\n\n  if (uuidKeys.length === 0) {\n    return [{\n      json: {\n        error: 'No drill query UUIDs found in input data',\n        inputKeys: Object.keys(inputData)\n      }\n    }];\n  }\n\n  let drill_queries = uuidKeys.map(document_query_id => ({\n    json: {\n      document_query_id: document_query_id,\n      document_query_name: drillQueries[document_query_id][0][\"document_query_name\"],\n      queries: drillQueries[document_query_id],\n      queryCount: drillQueries[document_query_id].length\n    }\n  }))\n\n  return drill_queries;"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2656,
          1120
        ],
        "id": "d9071922-dd3c-4544-8313-87cd21b0b593",
        "name": "Prepare UUID Loop Data"
      },
      {
        "parameters": {
          "jsCode": "const inputData = $('Load Drill Queries').first().json;\n  const systemFields = ['headers', 'params', 'query', 'webhookUrl', 'executionMode'];\n  const drillQueries = {};\n\n  for (const [key, value] of Object.entries(inputData)) {\n    if (!systemFields.includes(key) && typeof value === 'object' && Array.isArray(value)) {\n      drillQueries[key] = value;\n    }\n  }\n\n  const uuidKeys = Object.keys(drillQueries);\n\n  if (uuidKeys.length === 0) {\n    return [{\n      json: {\n        error: 'No drill query UUIDs found in input data',\n        inputKeys: Object.keys(inputData)\n      }\n    }];\n  }\n\n  let count = 0;\n  uuidKeys.forEach(uuid => count += drillQueries[uuid].length);\n\n  return {\n    \"drill_queries_count\": count\n  };"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          2352,
          1120
        ],
        "id": "347e89ad-1d53-4099-8d9d-20a8602b2c12",
        "name": "Get Drill Queries Count"
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"today\": \"2026-02-22\",\n  \"current_fiscal_quarter\": \"FY2027 Q1\",\n  \"previous_fiscal_quarter\": \"FY2026 Q4\",\n  \"current_fiscal_half\": \"FY2027 H1\",\n  \"previous_fiscal_half\": \"FY2026 H2\"\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          1296,
          1328
        ],
        "id": "0f55f706-a159-4c68-bb74-68f7dbe15efe",
        "name": "Structured Output Parser"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=<role>\nYou are a date-aware automation agent that, at runtime, uses the current calendar date and converts it into the organization’s fiscal quarter and fiscal half-year.\n</role>\n\n<task>\n1. Capture today’s date in ISO-8601 format (YYYY-MM-DD).  \n2. Derive the current fiscal quarter using this mapping:  \n   • February, March, April → Q1  \n   • May, June, July → Q2  \n   • August, September, October → Q3  \n   • November, December, January → Q4\n3. Similarly, derive the previous fiscal quarter.\n4. Then, derive the previous' previous fiscal quarter. In the end, you will have 3 fiscal quarters. From here on out, you will consider the \"current_fiscal_quarter\" to be your derived previous fiscal quarter and you will consider the \"previous_fiscal_quarter\" to be your derived 2 quarters previous. This is because we will run this at the end of each quarter that has just finished in order to compare this most recently finished fiscal quarter with 2 quarters ago.\n4. Determine the current fiscal half-year: \n   • H1 = Q1 + Q2 (February – July) \n   • H2 = Q3 + Q4 (August – January)\n5. Similarly to deriving the current fiscal half-year, derive the previous fiscal half-year\n6. Assign the fiscal year (FY):  \n   • FY is labelled by the calendar year of the January that closes Q4.  \n     – Example: any date from 2025-11-01 through 2026-01-31 belongs to FY2026 Q4.  \n7. If a month is ever missing from the mapping (unexpected), set  \n   \"fiscal_quarter\": \"Unmapped\", \"fiscal_half\": \"Unmapped\",  \n   add a \"warning\" key explaining why, and continue.  \n8. Produce one JSON object that follows the output_format section exactly.  \n9. Self-check: validate JSON syntax, confirm quarter/half/year logic, and flag any ambiguity or edge case before returning.\n</task>\n\n<context>\nThe organization follows a non-standard fiscal calendar that begins in February and spans ten active months, grouping them into the quarters above.  \nWe prefer the simplest workflow that fully handles edge cases (e.g., leap years, timezone differences, cross-year FY labelling) and follows security-best practices.\n</context>\n\n<examples>\n<fiscal_quarter_examples>\n2024-02-01 → FY2025 Q1  \n2024-05-15 → FY2025 Q2\n2024-07-29 → FY2025 Q2\n2024-08-01 → FY2025 Q3\n2024-10-30 → FY2025 Q3\n2024-12-30 → FY2025 Q4  \n2025-01-31 → FY2025 Q4\n2025-02-01 → FY2026 Q1\n2025-06-10 → FY2026 Q2  \n2025-09-05 → FY2026 Q3  \n2025-12-12 → FY2026 Q4  \n2026-03-03 → FY2027 Q1\n2026-05-22 → FY2027 Q2\n</fiscal_quarter_examples>\n\n<fiscal_half_examples>\n2024-02-01 → FY2025 H1\n2024-05-15 → FY2025 H1\n2024-07-29 → FY2025 H1\n2024-08-01 → FY2025 H2\n2024-10-30 → FY2025 H2\n2024-12-30 → FY2025 H2  \n2025-01-31 → FY2025 H2  \n2025-02-01 → FY2026 H1\n2025-06-10 → FY2026 H1  \n2025-09-05 → FY2026 H2  \n2025-12-12 → FY2026 H2  \n2026-03-03 → FY2027 H1\n2026-05-22 → FY2027 H1\n</fiscal_half_examples>\n\n</examples>\n\n<guidelines>\n- Output only the JSON object—no extra text.  \n- Keys must be lower_snake_case and wrapped in double quotes.  \n- Do not include trailing commas.  \n- Point out any implicit or non-obvious “gotchas” (e.g., FY roll-over rules) in the \"warning\" field instead of silently proceeding.  \n- Do not simply agree; highlight anything incorrect or sub-optimal and suggest improvements.  \n- Think step-by-step, then self-check that the response meets every instruction before returning it.\n</guidelines>\n\n<input>\ntoday: {{ $today.format('yyyy-MM-dd') }}\n</input>\n\n<output_format>\n{\n  \"today\": \"2026-05-22\",\n  \"current_fiscal_quarter\": \"FY2027 Q1\",\n  \"previous_fiscal_quarter\": \"FY2026 Q4\",\n  \"current_fiscal_half\": \"FY2027 H1\",\n  \"previous_fiscal_half\": \"FY2026 H2\"\n}\n</output_format>",
          "hasOutputParser": true,
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 3,
        "position": [
          1136,
          1120
        ],
        "id": "627f6fd7-713f-44fe-8a43-511b655cf548",
        "name": "Fiscal Quarter Extractor"
      },
      {
        "parameters": {
          "model": "o4-mini",
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatAzureOpenAi",
        "typeVersion": 1,
        "position": [
          1120,
          1328
        ],
        "id": "5421085b-5efc-40de-895d-5f9d003d2ddf",
        "name": "o4-mini",
        "credentials": {
          "azureOpenAiApi": {
            "id": "N96DE6AiByL8h8kA",
            "name": "Azure OpenAI o4-mini"
          }
        }
      },
      {
        "parameters": {
          "httpMethod": "POST",
          "path": "board-deck-takeaways-ze5ubv1w",
          "authentication": "basicAuth",
          "responseMode": "responseNode",
          "options": {
            "responseHeaders": {
              "entries": [
                {
                  "name": "Content-Type",
                  "value": "application/json"
                }
              ]
            }
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2.1,
        "position": [
          224,
          1392
        ],
        "id": "6ed5e716-a593-43f8-a2a5-ff2b55e7606a",
        "name": "Trigger",
        "webhookId": "1298ec1c-5d6c-4010-9b21-b40fada0aa39",
        "alwaysOutputData": true,
        "credentials": {
          "httpBasicAuth": {
            "id": "3AVUqEU99hkVKUOW",
            "name": "Zapier Inbound Basic Auth Webhook"
          }
        }
      },
      {
        "parameters": {
          "respondWith": "noData",
          "options": {
            "responseCode": 202
          }
        },
        "type": "n8n-nodes-base.respondToWebhook",
        "typeVersion": 1.5,
        "position": [
          480,
          1392
        ],
        "id": "ee9d858a-7473-476a-8e2d-509ceb132fb6",
        "name": "Respond to Webhook"
      },
      {
        "parameters": {
          "resource": "folder",
          "name": "=Board_Deck_Takeaways_{{ $now.format('yyyyMMdd_HHmmss') }}",
          "driveId": {
            "__rl": true,
            "value": "My Drive",
            "mode": "list",
            "cachedResultName": "My Drive",
            "cachedResultUrl": "https://drive.google.com/drive/my-drive"
          },
          "folderId": {
            "__rl": true,
            "value": "1dSd5PWJ0BH1ksydt-GnYJraDhwLnAbGZ",
            "mode": "list",
            "cachedResultName": "AI Workflow - Board Deck Takeaways",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1dSd5PWJ0BH1ksydt-GnYJraDhwLnAbGZ"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          1600,
          1120
        ],
        "id": "15d9460c-b80f-4f00-9421-f1073c6e8a94",
        "name": "Create folder",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "SgST8lxFUWMslYat",
            "name": "Google Drive Cribl"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "fa236bc3-f105-4270-adb5-2552a04a69e5",
                "name": "google_drive_folder_id",
                "value": "={{ $('Create folder').item.json.id }}",
                "type": "string"
              },
              {
                "id": "230fa6da-2b61-420f-b2d7-10d6cacf6c5d",
                "name": "current_fiscal_quarter",
                "value": "={{ $('Fiscal Quarter Extractor').item.json.output.current_fiscal_quarter }}",
                "type": "string"
              },
              {
                "id": "b0c57526-3be8-49d0-8967-0af6a965063d",
                "name": "previous_fiscal_quarter",
                "value": "={{ $('Fiscal Quarter Extractor').item.json.output.previous_fiscal_quarter }}",
                "type": "string"
              },
              {
                "id": "80a8a4e9-2554-474e-aada-25bfdbddb519",
                "name": "default_user_id",
                "value": "={{ $('Global Vars').item.json.default_user_id }}",
                "type": "string"
              }
            ]
          },
          "includeOtherFields": true,
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          3424,
          1280
        ],
        "id": "2644febc-6619-4de2-ac6c-b17278e1c02d",
        "name": "Loop UUID Item"
      },
      {
        "parameters": {
          "content": "- No matter how many drill query sort versions that a drill query has, this loop (which goes for each drill query) should only still input one takeaway per drill query"
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          6528,
          2048
        ],
        "typeVersion": 1,
        "id": "6c326fa0-6fd2-4005-ab4b-69c5de620beb",
        "name": "Sticky Note2"
      },
      {
        "parameters": {
          "content": "- No matter how many drill queries (and thus drill query sort versions) that a document query has, this loop (which goes for each document query/chart) should only still create one google doc within the folder per document query",
          "height": 208
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          4784,
          1760
        ],
        "typeVersion": 1,
        "id": "8dc7f025-9cef-4f86-9278-e4d352662333",
        "name": "Sticky Note3"
      },
      {
        "parameters": {
          "workflowId": {
            "__rl": true,
            "value": "mDJHNy6DrprAll2W",
            "mode": "list",
            "cachedResultUrl": "/workflow/mDJHNy6DrprAll2W",
            "cachedResultName": "Board_Deck_Document_Query_Analysis_Subworkflow"
          },
          "workflowInputs": {
            "mappingMode": "defineBelow",
            "value": {
              "input": "={{ $json }}"
            },
            "matchingColumns": [
              "input"
            ],
            "schema": [
              {
                "id": "input",
                "displayName": "input",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "canBeUsedToMatch": true,
                "type": "object",
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": true
          },
          "options": {
            "waitForSubWorkflow": false
          }
        },
        "type": "n8n-nodes-base.executeWorkflow",
        "typeVersion": 1.3,
        "position": [
          3632,
          1280
        ],
        "id": "0d71b9a5-7d56-4e33-92f6-ccc9a2216c29",
        "name": "Call 'Board_Deck_Document_Query_Analysis_Subworkflow'"
      },
      {
        "parameters": {
          "content": "## High number of measures\n```\n{\n  \"c3023df3-39f1-4913-86c8-07d69f6caeb1\": [\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_customers\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.customer_type\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\",\n          \"finance__customer_quarterly_arr.total_churn_arr\",\n          \"finance__customer_quarterly_arr.total_downsell_arr\",\n          \"finance__customer_quarterly_arr.total_ending_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"e3a78095-f13c-49a2-9a4c-617fca386ca4\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    \\\"CUSTOMER_TYPE\\\" AS \\\"finance__customer_quarterly_arr.customer_type\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"CHURN_ARR\\\" < 0 THEN \\\"CHURN_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_churn_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"DOWNSELL_ARR\\\" < 0 THEN \\\"DOWNSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_downsell_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"ENDING_ARR\\\" > 0 THEN \\\"ENDING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_ending_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 5, 3, 1\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_migration_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.customer_type\",\n          \"finance__customer_quarterly_arr.total_migration_arr\",\n          \"finance__customer_quarterly_arr.migration_arr_cloud\",\n          \"finance__customer_quarterly_arr.migration_arr_software\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"df073f20-17b0-4d9c-b667-2b2f86b5fae8\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    \\\"CUSTOMER_TYPE\\\" AS \\\"finance__customer_quarterly_arr.customer_type\\\",\\n    COALESCE(SUM(\\\"MIGRATION_ARR_CLOUD\\\"), 0) AS \\\"finance__customer_quarterly_arr.total_migration_arr\\\",\\n    \\\"MIGRATION_ARR_CLOUD\\\" AS \\\"finance__customer_quarterly_arr.migration_arr_cloud\\\",\\n    \\\"MIGRATION_ARR_SOFTWARE\\\" AS \\\"finance__customer_quarterly_arr.migration_arr_software\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 5, 3, 1, 7, 8\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_gross_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [\n          {\n            \"column_name\": \"finance__customer_quarterly_arr.total_starting_arr\",\n            \"sort_descending\": true\n          }\n        ],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"51b818b3-a897-4ede-a516-ab7436c6be97\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 3, 1\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_gross_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [\n          {\n            \"column_name\": \"finance__customer_quarterly_arr.total_new_arr\",\n            \"sort_descending\": true\n          }\n        ],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"51b818b3-a897-4ede-a516-ab7436c6be97\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 3, 1\\nLIMIT 1000\"\n    },\n    {\n      \"document_query_name\": \"Incremental Cloud ARR and Customers Over Time\",\n      \"drill_name\": \"total_gross_new_arr\",\n      \"query\": {\n        \"limit\": 1000,\n        \"sorts\": [\n          {\n            \"column_name\": \"finance__customer_quarterly_arr.total_upsell_arr\",\n            \"sort_descending\": true\n          }\n        ],\n        \"table\": \"finance__customer_quarterly_arr\",\n        \"fields\": [\n          \"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\",\n          \"finance__customer_quarterly_arr.customer_name\",\n          \"finance__customer_quarterly_arr.first_purchase_quarter[date]\",\n          \"finance__customer_quarterly_arr.cribl_id\",\n          \"finance__customer_quarterly_arr.total_starting_arr\",\n          \"finance__customer_quarterly_arr.total_new_arr\",\n          \"finance__customer_quarterly_arr.total_upsell_arr\"\n        ],\n        \"pivots\": [],\n        \"dbtMode\": false,\n        \"filters\": {\n          \"finance__customer_quarterly_arr.fiscal_quarter\": {\n            \"type\": \"composite\",\n            \"filters\": [\n              {\n                \"kind\": \"TIME_FOR_UNIT_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"FY2026 Q3\"\n              },\n              {\n                \"kind\": \"TIME_FOR_INTERVAL_DURATION\",\n                \"type\": \"date\",\n                \"left_side\": \"6 complete fiscal quarters ago\",\n                \"right_side\": \"6 quarters\",\n                \"is_negative\": false\n              }\n            ],\n            \"conjunction\": \"AND\",\n            \"is_negative\": false\n          },\n          \"finance__customer_quarterly_arr.source_granularity\": {\n            \"kind\": \"EQUALS\",\n            \"type\": \"string\",\n            \"values\": [\n              \"cloud\"\n            ]\n          }\n        },\n        \"modelId\": \"51b818b3-a897-4ede-a516-ab7436c6be97\",\n        \"version\": 8,\n        \"controls\": [],\n        \"rewriteSql\": true,\n        \"row_totals\": {},\n        \"fill_fields\": [],\n        \"calculations\": [],\n        \"column_limit\": 50,\n        \"join_via_map\": {},\n        \"column_totals\": {},\n        \"userEditedSQL\": \"\",\n        \"dimensionIndex\": 0,\n        \"default_group_by\": true,\n        \"custom_summary_types\": {},\n        \"join_paths_from_topic_name\": \"customer_quarterly_arr\"\n      },\n      \"sql\": \"SELECT 'FY' || CAST(EXTRACT(YEAR FROM (\\\"FISCAL_QUARTER\\\" + INTERVAL '11 month')) AS VARCHAR) || (' Q' || CAST(CAST(FLOOR((MOD(EXTRACT(MONTH FROM \\\"FISCAL_QUARTER\\\") + -13, 12) + 12 - 1) / 3) AS BIGINT) + 1 AS VARCHAR)) AS \\\"finance__customer_quarterly_arr.fiscal_quarter[fiscal_quarter]\\\",\\n    \\\"CUSTOMER_NAME\\\" AS \\\"finance__customer_quarterly_arr.customer_name\\\",\\n    CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)) AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]__raw\\\",\\n    \\\"CRIBL_ID\\\" AS \\\"finance__customer_quarterly_arr.cribl_id\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"STARTING_ARR\\\" > 0 THEN \\\"STARTING_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_starting_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"NEW_ARR\\\" > 0 THEN \\\"NEW_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_new_arr\\\",\\n    COALESCE(SUM(CASE\\n        WHEN \\\"UPSELL_ARR\\\" > 0 THEN \\\"UPSELL_ARR_CLOUD\\\"\\n        ELSE NULL\\n    END), 0) AS \\\"finance__customer_quarterly_arr.total_upsell_arr\\\",\\n    TO_CHAR(CAST(DATE_TRUNC('DAY', \\\"FIRST_PURCHASE_QUARTER\\\") AS TIMESTAMP(0)), 'YYYY-MM-DD') AS \\\"finance__customer_quarterly_arr.first_purchase_quarter[date]\\\"\\nFROM \\\"FINANCE\\\".\\\"CUSTOMER_QUARTERLY_ARR\\\" AS \\\"finance__customer_quarterly_arr\\\"\\nWHERE \\\"FISCAL_QUARTER\\\" >= CAST(TIMESTAMP '2025-08-01 00:00:00' AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', ((TIMESTAMP '2025-08-01 00:00:00' + INTERVAL '3 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" >= CAST((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE) AND \\\"FISCAL_QUARTER\\\" < CAST((DATE_TRUNC('QUARTER', (((DATE_TRUNC('QUARTER', ((CAST(CURRENT_TIMESTAMP AS TIMESTAMP(0)) + INTERVAL '-18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') + INTERVAL '18 month') + INTERVAL '2 month')) + INTERVAL '-2 month') AS DATE)\\nGROUP BY 4, 2, 3, 1\\nLIMIT 1000\"\n    }\n  ]\n}\n```"
        },
        "type": "n8n-nodes-base.stickyNote",
        "position": [
          2000,
          784
        ],
        "typeVersion": 1,
        "id": "15463490-f48d-43c9-acaf-f0700a88a72a",
        "name": "Sticky Note"
      }
    ],
    "connections": {
      "When clicking 'Execute workflow'": {
        "main": [
          [
            {
              "node": "Global Vars",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Global Vars": {
        "main": [
          [
            {
              "node": "Fiscal Quarter Extractor",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Load Drill Queries": {
        "main": [
          [
            {
              "node": "Get Drill Queries Count",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop Over UUIDs": {
        "main": [
          [],
          [
            {
              "node": "Loop UUID Item",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prepare UUID Loop Data": {
        "main": [
          [
            {
              "node": "Loop Over UUIDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get Drill Queries Count": {
        "main": [
          [
            {
              "node": "Prepare UUID Loop Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Fiscal Quarter Extractor",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Fiscal Quarter Extractor": {
        "main": [
          [
            {
              "node": "Create folder",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "o4-mini": {
        "ai_languageModel": [
          [
            {
              "node": "Fiscal Quarter Extractor",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Trigger": {
        "main": [
          [
            {
              "node": "Respond to Webhook",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Respond to Webhook": {
        "main": [
          [
            {
              "node": "Global Vars",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Create folder": {
        "main": [
          [
            {
              "node": "Load Drill Queries",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Loop UUID Item": {
        "main": [
          [
            {
              "node": "Call 'Board_Deck_Document_Query_Analysis_Subworkflow'",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Call 'Board_Deck_Document_Query_Analysis_Subworkflow'": {
        "main": [
          [
            {
              "node": "Loop Over UUIDs",
              "type": "main",
              "index": 0
            }
          ]
        ]
      }
    },
    "authors": "Nathan K",
    "name": null,
    "description": null
  },
  "tags": []
}