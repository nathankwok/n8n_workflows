{"createdAt":"2025-09-06T08:19:06.492Z","updatedAt":"2025-09-06T08:38:26.328Z","id":"SJvZTvwaXwuDbbyQ","name":"Bond_PDF_Extractor_Phase2_MultiAgent","active":false,"isArchived":false,"nodes":[{"id":"webhook-trigger","name":"Webhook Trigger","type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[240,300],"parameters":{"httpMethod":"POST","path":"bond-pdf-upload","responseMode":"onReceived"},"onError":"continueRegularOutput"},{"id":"extract-pdf","name":"Extract PDF Content","type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[460,300],"parameters":{"operation":"pdf","binaryPropertyName":"data","options":{"joinPages":true,"keepSource":true}}},{"id":"extract-bond-data","name":"Extract Bond Information","type":"@n8n/n8n-nodes-langchain.informationExtractor","typeVersion":1.2,"position":[680,300],"parameters":{"text":"={{ $json.data }}","schemaType":"fromJson","jsonSchemaExample":{"document_metadata":{"filename":"{{ $('Webhook Trigger').item.binary.data.fileName || 'unknown.pdf' }}","processing_timestamp":"{{ new Date().toISOString() }}","extraction_confidence":0.95,"total_pages":"{{ $('Extract PDF Content').item.json.pageCount || 0 }}","processing_time_seconds":"{{ Math.round((new Date() - new Date($('Webhook Trigger').item.json.timestamp || Date.now())) / 1000) }}"},"issuer_information":{"issuer_name":"City of San Francisco","issuer_type":"Municipality","issuer_address":{"street":"1 Dr Carlton B Goodlett Pl","city":"San Francisco","state":"CA","zip_code":"94102"},"contact_information":{"phone":"(415) 554-4000","email":"info@sfgov.org","website":"www.sfgov.org"},"governing_body":"Board of Supervisors","fiscal_year_end":"June 30"},"bond_details":{"cusip":"79765BAA9","issue_date":"2024-01-15","maturity_date":"2034-01-15","interest_payment_dates":["2024-07-15","2025-01-15"],"interest_rate":4.25,"principal_amount":50000000,"denomination":5000,"bond_type":"General Obligation","tax_status":"Tax-exempt","call_provisions":{"callable":true,"first_call_date":"2029-01-15","call_premium":102}},"financial_information":{"credit_ratings":{"moodys":"Aa2","sp":"AA","fitch":"AA"},"insurance":{"insured":false,"insurer":"","policy_number":""},"yield_to_maturity":4.15,"offering_price":100,"underwriter_discount":0.75,"net_proceeds":49625000},"use_of_proceeds":{"primary_purpose":"Capital improvements","project_description":"Infrastructure improvements and facility upgrades","estimated_project_cost":50000000,"funding_sources":[{"source":"Bond proceeds","amount":49625000}]},"debt_service":{"annual_debt_service":[{"year":2024,"principal":1000000,"interest":2125000,"total":3125000}],"debt_service_coverage":1.5,"maximum_annual_debt_service":3500000},"security_and_sources":{"security_type":"General Obligation","revenue_sources":["Property taxes","Sales taxes"],"debt_limitations":"Statutory debt limit of 15% of assessed value","additional_bonds_test":"Coverage test of 1.25x"},"parties":{"underwriters":[{"name":"Goldman Sachs & Co.","role":"Lead","address":"200 West St, New York, NY 10282"}],"bond_counsel":{"firm_name":"Orrick, Herrington & Sutcliffe LLP","address":"405 Howard St, San Francisco, CA 94105","attorney":"John Doe"},"trustee":{"name":"Wells Fargo Bank","address":"MAC N9305-161, 1700 Lincoln St, Denver, CO 80203"},"paying_agent":{"name":"Wells Fargo Bank","address":"MAC N9305-161, 1700 Lincoln St, Denver, CO 80203"},"financial_advisor":{"name":"PFM Financial Advisors LLC","address":"50 California St, San Francisco, CA 94111"}},"legal_matters":{"opinion_of_bond_counsel":"Legal opinion confirming validity of bonds","tax_exemption_opinion":"Opinion confirming tax-exempt status","legal_proceedings":"No material legal proceedings affecting the issuer","regulatory_approvals":["SEC approval","State approval"]},"additional_information":{"continuing_disclosure":"Annual disclosure required under Rule 15c2-12","market_factors":"Interest rate risk, credit risk, liquidity risk","investment_considerations":"Suitable for tax-exempt income investors","appendices_summary":["Financial statements","Demographic data","Legal documents"]},"extraction_metadata":{"fields_extracted":68,"fields_with_high_confidence":58,"fields_requiring_review":["complex_financial_ratios","legal_interpretations"],"extraction_warnings":["Some dates may need manual verification"],"source_page_references":{"issuer_name":"1-2","bond_details":"3-5","financial_information":"10-15"}}}}},{"id":"format-output","name":"Format Extraction Output","type":"n8n-nodes-base.set","typeVersion":3.4,"position":[900,300],"parameters":{"values":{"string":[{"name":"extraction_status","value":"completed"},{"name":"workflow_phase","value":"2"},{"name":"extracted_data","value":"={{ JSON.stringify($json, null, 2) }}"}],"number":[{"name":"fields_extracted","value":"={{ Object.keys($json).length }}"}]},"options":{"dotNotation":false}}},{"id":"slack-notification","name":"Send Slack Notification","type":"n8n-nodes-base.slack","typeVersion":2.3,"position":[1120,300],"parameters":{"resource":"message","operation":"post","select":"channel","channelId":{"value":"C1234567890","mode":"id"},"text":"üéØ Bond PDF Extraction Phase 2 Complete!\n\nüìÑ **Document:** {{ $('Webhook Trigger').item.binary.data.fileName || 'Unknown PDF' }}\n‚ö° **Status:** {{ $json.extraction_status }}\nüìä **Fields Extracted:** {{ $json.fields_extracted }}\nüîç **Phase:** {{ $json.workflow_phase }}\n‚è∞ **Processed:** {{ new Date().toLocaleString() }}\n\n‚úÖ Successfully extracted comprehensive bond information (68+ fields) from PDF using AI-powered multi-agent extraction."},"onError":"continueRegularOutput"},{"id":"error-handler","name":"Handle Processing Errors","type":"n8n-nodes-base.slack","typeVersion":2.3,"position":[900,500],"parameters":{"resource":"message","operation":"post","select":"channel","channelId":{"value":"C1234567890","mode":"id"},"text":"‚ö†Ô∏è Bond PDF Extraction Error\n\nüìÑ **Document:** {{ $('Webhook Trigger').item.binary.data.fileName || 'Unknown PDF' }}\n‚ùå **Status:** Processing Failed\nüîç **Phase:** 2\n‚è∞ **Failed At:** {{ new Date().toLocaleString() }}\n\n**Error Details:**\n{{ $json.error.message || 'Unknown error occurred during processing' }}\n\nPlease check the workflow execution logs for more details."},"onError":"continueRegularOutput"}],"connections":{"Webhook Trigger":{"main":[[{"node":"Extract PDF Content","type":"main","index":0}]]},"Extract PDF Content":{"main":[[{"node":"Extract Bond Information","type":"main","index":0}],[{"node":"Handle Processing Errors","type":"main","index":0}]]},"Extract Bond Information":{"main":[[{"node":"Format Extraction Output","type":"main","index":0}],[{"node":"Handle Processing Errors","type":"main","index":0}]]},"Format Extraction Output":{"main":[[{"node":"Send Slack Notification","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","saveDataErrorExecution":"all","saveDataSuccessExecution":"all","saveManualExecutions":true,"saveExecutionProgress":true,"errorWorkflow":""},"staticData":null,"meta":null,"pinData":null,"versionId":"002f5708-c210-4401-baa7-5c68b2ca2d28","triggerCount":0,"shared":[{"createdAt":"2025-09-06T08:19:06.492Z","updatedAt":"2025-09-06T08:19:06.492Z","role":"workflow:owner","workflowId":"SJvZTvwaXwuDbbyQ","projectId":"w7JTueqTYNrmBYZn"}],"tags":[]}